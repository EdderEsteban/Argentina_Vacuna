extends ../__layout/main

block content
  .container.mt-4
    h1.mb-4 ðŸ“‹ Listado de Movimientos de Lotes

    //- BotÃ³n de nuevo lote
    a.btn.btn-primary.mb-3(href='/nuevomovimiento')
      i.bi.bi-plus-circle.me-2
      | Nuevo Movimiento

    .table-responsive
      table.table.table-striped
        thead.table-dark
          tr
            th Lote
            th Origen
            th Destino
            th Cantidad
            th Estado
            th Fecha
        tbody
          each m in movimientos
            tr
              td= m.lote.num_lote
              td= m.origen ? `${m.origen.nombre} (${m.origen.tipo})` : 'DepÃ³sito Nacional'
              td= `${m.destino.nombre} (${m.destino.tipo})`
              td= m.cantidad
              td
                if mov.lote.vacunas && mov.lote.vacunas[0]
                  span.badge(
                    class={
                      'bg-success': mov.lote.vacunas[0].estado.codigo === 'DNAC',
                      'bg-warning': mov.lote.vacunas[0].estado.codigo === 'DPRO',
                      'bg-info': mov.lote.vacunas[0].estado.codigo === 'TRANS',
                      'bg-primary': mov.lote.vacunas[0].estado.codigo === 'VACU',
                      'bg-secondary': mov.lote.vacunas[0].estado.codigo === 'APLI',
                      'bg-danger': mov.lote.vacunas[0].estado.codigo === 'VENC',
                      'bg-dark': mov.lote.vacunas[0].estado.codigo === 'DESC'
                    }
                  )= mov.lote.vacunas[0].estado.nombre
                else
                  span.badge.bg-light.text-dark Sin estado

              td= new Date(m.fecha_movimiento).toLocaleDateString()

    nav(aria-label='PaginaciÃ³n')
      ul.pagination.justify-content-center
        if pagination.hasPreviousPage
          li.page-item
            a.page-link(href=`/movimientos?page=${pagination.currentPage - 1}`) Anterior
        - for (let i = 1; i <= pagination.totalPages; i++)
          li.page-item(class=i === pagination.currentPage ? 'active' : '')
            a.page-link(href=`/movimientos?page=${i}`)= i
        if pagination.hasNextPage
          li.page-item
            a.page-link(href=`/movimientos?page=${pagination.currentPage + 1}`) Siguiente